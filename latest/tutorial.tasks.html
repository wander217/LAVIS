<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adding Tasks &mdash; LAVIS  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Adding Models" href="tutorial.models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> LAVIS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">What is LAVIS?</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#supported-tasks-models-and-datasets">Supported Tasks, Models and Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#library-design">Library Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#installation">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Dataset Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#auto-downloading-and-loading-datasets">Auto-Downloading and Loading Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#model-zoo">Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#inference-with-pre-trained-models">Inference with Pre-trained Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#unified-feature-extraction-interface">Unified Feature Extraction Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmark</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.evaluation.html">Evaluating Pre-trained Models on Task Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.training-example.html">Example on Finetuning BLIP on COCO-Captioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.training-example.html#available-configurations">Available Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.configs.html">Training Models on Task Datasets (Commands and Configurations)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.datasets.html">Adding Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.processors.html">Adding Processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.models.html">Adding Models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adding Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#base-task-lavis-tasks-base-task">Base Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.base_task</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dialogue-task-lavis-tasks-dialogue">Dialogue Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.dialogue</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#registering-new-task-lavis-tasks-init">Registering New Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.__init__</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#assigning-task">Assigning Task</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LAVIS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="tutorial.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Adding Tasks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.tasks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="adding-tasks">
<h1>Adding Tasks<a class="headerlink" href="#adding-tasks" title="Permalink to this heading"></a></h1>
<p>This is a tutorial on adding new machine learning tasks using <code class="docutils literal notranslate"><span class="pre">lavis.tasks</span></code> module.</p>
<p>The LAVIS library includes a standard task module that centralizes the model training and evaluation procedure of machine learning tasks.
The <code class="docutils literal notranslate"><span class="pre">lavis.tasks</span></code> module is designed such that any new tasks can be added and integrated, catering to any customization in the training and testing procedures.
In this tutorial, we will replicate the steps to add a new task into LAVIS for the <a class="reference external" href="https://arxiv.org/pdf/1901.09107.pdf">video-grounded dialogue tasks</a>.</p>
<section id="base-task-lavis-tasks-base-task">
<h2>Base Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.base_task</span></code><a class="headerlink" href="#base-task-lavis-tasks-base-task" title="Permalink to this heading"></a></h2>
<p>Note that any new model definition should inherit the base task class <code class="docutils literal notranslate"><span class="pre">BaseTask</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">torch.distributed</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">lavis.common.dist_utils</span> <span class="kn">import</span> <span class="n">get_rank</span><span class="p">,</span> <span class="n">get_world_size</span><span class="p">,</span> <span class="n">is_main_process</span>
<span class="kn">from</span> <span class="nn">lavis.common.logger</span> <span class="kn">import</span> <span class="n">MetricLogger</span><span class="p">,</span> <span class="n">SmoothedValue</span>
<span class="kn">from</span> <span class="nn">lavis.common.registry</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="kn">from</span> <span class="nn">lavis.datasets.data_utils</span> <span class="kn">import</span> <span class="n">prepare_sample</span>

<span class="k">class</span> <span class="nc">BaseTask</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inst_id_key</span> <span class="o">=</span> <span class="s2">&quot;instance_id&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setup_task</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
        <span class="n">model_config</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">model_cfg</span>

        <span class="n">model_cls</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get_model_class</span><span class="p">(</span><span class="n">model_config</span><span class="o">.</span><span class="n">arch</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">model_config</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">build_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a dictionary of datasets, keyed by split &#39;train&#39;, &#39;valid&#39;, &#39;test&#39;.</span>
<span class="sd">        Download dataset and annotations automatically if not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            cfg (common.config.Config): _description_</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary of torch.utils.data.Dataset objects by split.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">datasets</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">datasets_config</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">datasets_cfg</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets_config</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;At least one dataset has to be specified.&quot;</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">datasets_config</span><span class="p">:</span>
            <span class="n">dataset_config</span> <span class="o">=</span> <span class="n">datasets_config</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

            <span class="n">builder</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="n">get_builder_class</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="n">dataset_config</span><span class="p">)</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_datasets</span><span class="p">()</span>

            <span class="n">datasets</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>

        <span class="k">return</span> <span class="n">datasets</span>

    <span class="k">def</span> <span class="nf">train_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">samples</span><span class="p">)[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">loss</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>In this base task, we already declare and standardize many common methods such as <code class="docutils literal notranslate"><span class="pre">train_step</span></code>, <code class="docutils literal notranslate"><span class="pre">build_model</span></code>, and <code class="docutils literal notranslate"><span class="pre">build_datasets</span></code>.
Inheriting this base task class allows us to standardize operations of tasks across all task classes.
We recommend users not change the implementation of the base task class as this will have an impact on all existing task subclasses.</p>
</section>
<section id="dialogue-task-lavis-tasks-dialogue">
<h2>Dialogue Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.dialogue</span></code><a class="headerlink" href="#dialogue-task-lavis-tasks-dialogue" title="Permalink to this heading"></a></h2>
<p>In this step, we can define a new task class, e.g. under <code class="docutils literal notranslate"><span class="pre">lavis.tasks.dialogue</span></code>, for video-grounded dialogues.
For instance, we define a new task class <code class="docutils literal notranslate"><span class="pre">DialogueTask</span></code> that inherits the super task class <code class="docutils literal notranslate"><span class="pre">BaseTask</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">lavis.common.dist_utils</span> <span class="kn">import</span> <span class="n">main_process</span>
<span class="kn">from</span> <span class="nn">lavis.common.logger</span> <span class="kn">import</span> <span class="n">MetricLogger</span>
<span class="kn">from</span> <span class="nn">lavis.common.registry</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="kn">from</span> <span class="nn">lavis.tasks.base_task</span> <span class="kn">import</span> <span class="n">BaseTask</span>
<span class="kn">from</span> <span class="nn">lavis.datasets.data_utils</span> <span class="kn">import</span> <span class="n">prepare_sample</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@registry</span><span class="o">.</span><span class="n">register_task</span><span class="p">(</span><span class="s2">&quot;dialogue&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">DialogueTask</span><span class="p">(</span><span class="n">BaseTask</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_beams</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">min_len</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">,</span> <span class="n">report_metric</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_beams</span> <span class="o">=</span> <span class="n">num_beams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_len</span> <span class="o">=</span> <span class="n">max_len</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_len</span> <span class="o">=</span> <span class="n">min_len</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span> <span class="o">=</span> <span class="n">evaluate</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">report_metric</span> <span class="o">=</span> <span class="n">report_metric</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setup_task</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
        <span class="n">run_cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">run_cfg</span>

        <span class="n">num_beams</span> <span class="o">=</span> <span class="n">run_cfg</span><span class="o">.</span><span class="n">num_beams</span>
        <span class="n">max_len</span> <span class="o">=</span> <span class="n">run_cfg</span><span class="o">.</span><span class="n">max_len</span>
        <span class="n">min_len</span> <span class="o">=</span> <span class="n">run_cfg</span><span class="o">.</span><span class="n">min_len</span>
        <span class="n">evaluate</span> <span class="o">=</span> <span class="n">run_cfg</span><span class="o">.</span><span class="n">evaluate</span>

        <span class="n">report_metric</span> <span class="o">=</span> <span class="n">run_cfg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;report_metric&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">num_beams</span><span class="o">=</span><span class="n">num_beams</span><span class="p">,</span>
            <span class="n">max_len</span><span class="o">=</span><span class="n">max_len</span><span class="p">,</span>
            <span class="n">min_len</span><span class="o">=</span><span class="n">min_len</span><span class="p">,</span>
            <span class="n">evaluate</span><span class="o">=</span><span class="n">evaluate</span><span class="p">,</span>
            <span class="n">report_metric</span><span class="o">=</span><span class="n">report_metric</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">valid_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">samples</span><span class="p">)[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">loss</span><span class="p">]</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Note that for any new task, we advise the users to review carefully the functions implemented within <code class="docutils literal notranslate"><span class="pre">BaseTask</span></code> and consider which methods should be modified.
For instance, the base task class already contains a standard implementation of model training steps that are common among machine learning steps.
Some major methods we want to emphasize and should be customized by each task are the <code class="docutils literal notranslate"><span class="pre">valid_step</span></code> and <code class="docutils literal notranslate"><span class="pre">evaluation</span></code>.
These operations were not fully implemented in the base task class due to the differences in evaluation procedures among many machine learning tasks.
Another method that should be considered is the <code class="docutils literal notranslate"><span class="pre">setup_task</span></code> method.
This method will receive configurations that set task-specific parameters to initialize any task instance.</p>
</section>
<section id="registering-new-task-lavis-tasks-init">
<h2>Registering New Task <code class="docutils literal notranslate"><span class="pre">lavis.tasks.__init__</span></code><a class="headerlink" href="#registering-new-task-lavis-tasks-init" title="Permalink to this heading"></a></h2>
<p>Any new task must be officially registered as part of the <code class="docutils literal notranslate"><span class="pre">lavis.tasks</span></code> module. For instance, to add a new task for video-grounded dialogues, we can modify the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lavis.tasks.dialogue</span> <span class="kn">import</span> <span class="n">DialogueTask</span>

<span class="o">...</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">...</span>
    <span class="s2">&quot;DialogueTask&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="assigning-task">
<h2>Assigning Task<a class="headerlink" href="#assigning-task" title="Permalink to this heading"></a></h2>
<p>From the above example of task class, note that we define a <code class="docutils literal notranslate"><span class="pre">setup_task</span></code> method for each task class.
This method will process a configuration file and pass specific parameters e.g. <code class="docutils literal notranslate"><span class="pre">num_beams</span></code> (for beam search generative tasks during the inference stage), to initialize the task classes properly.
To assign and associate any task, we need to specify the correct registry of task classes in a configuration file.
For instance, the following should be specified in a configuration file e.g. <code class="docutils literal notranslate"><span class="pre">dialogue_avsd_ft.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">run</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dialogue</span><span class="w"> </span><span class="c1"># name of the task</span><span class="w"></span>

<span class="w">  </span><span class="c1"># optimizer</span><span class="w"></span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>

<span class="w">  </span><span class="nt">max_len</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"></span>
<span class="w">  </span><span class="nt">min_len</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"></span>
<span class="w">  </span><span class="nt">num_beams</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class="w"></span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span><span class="w"></span>
</pre></div>
</div>
<p>Subsequently, any processes (e.g. training) should load this configuration file to assign the correct task.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python train.py --cfg-path dialogue_avsd_ft.yaml
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.models.html" class="btn btn-neutral float-left" title="Adding Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, salesforce.com inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>